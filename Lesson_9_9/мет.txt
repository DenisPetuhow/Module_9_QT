Механика работы с классами UDP в Qt
UDP (User Datagram Protocol) — это протокол "без соединения". В отличие от TCP, где мы сначала "звоним" и устанавливаем связь, в UDP мы просто "кидаем письмо в почтовый ящик".

В Qt для этого используются два основных класса: QUdpSocket и QNetworkDatagram.

1. Класс QUdpSocket (Почтальон)
Это основной инструмент. Он умеет делать три вещи: занимать порт, отправлять данные и слушать входящие данные.

bind(Address, Port) — "Занять место": Прежде чем принимать письма, сокет должен "арендовать почтовый ящик" (порт).

C++

socket->bind(QHostAddress::LocalHost, 12345);
Это говорит операционной системе: "Все пакеты, пришедшие на порт 12345, отдавай мне". Без этого метода ты сможешь только отправлять, но не принимать.

writeDatagram(Data, Address, Port) — "Отправить письмо": Поскольку постоянного соединения нет, каждый раз при отправке ты обязан указывать, кому (IP адрес) и куда (порт) ты шлешь данные.

C++

socket->writeDatagram(data, QHostAddress::LocalHost, 12345);
Сигнал readyRead — "Вам письмо!": Сокет работает асинхронно. Программа не "зависает" в ожидании данных. Как только на порт что-то пришло, QUdpSocket испускает сигнал readyRead. Мы ловим этот сигнал в слоте readPendingDatagrams.

2. Класс QNetworkDatagram (Конверт)
В старых версиях Qt работали просто с массивом байт (char*). Но в современном Qt (Qt 5.8+) появился этот класс-обертка. Он очень важен.

Представь, что тебе пришло письмо без обратного адреса. Ты его прочитал, но не знаешь, кому ответить. QNetworkDatagram решает эту проблему.

Что внутри датаграммы?

Данные (data()): Само сообщение (байты).

Адрес отправителя (senderAddress()): IP того, кто прислал пакет.

Порт отправителя (senderPort()): Порт, с которого ушел пакет.

3. Алгоритм приема (цикл while)
Почему в коде используется цикл while?

C++

void UDPworker::readPendingDatagrams()
{
    // Пока в "ящике" есть письма...
    while(__serviceUdpSocket->hasPendingDatagrams()){
            // ...достаем конверт целиком
            QNetworkDatagram datagram = __serviceUdpSocket->receiveDatagram();
            
            // Читаем данные и мета-информацию
            process(datagram); 
    }
}
UDP — быстрый протокол. Пока твой процессор обрабатывал первый пакет, в сетевую карту могли прилететь еще два. Если не использовать while, ты прочитаешь только первый, а остальные останутся "висеть" в буфере до следующего сигнала (или потеряются при переполнении буфера).

Итоговая схема взаимодействия:
Инициализация: QUdpSocket создается и делает bind() (открывает порт).

Ожидание: Программа работает, интерфейс не висит.

Событие: Кто-то из сети (или мы сами) прислал пакет.

Сигнал: Сокет кричит: readyRead!.

Слот: Мы заходим в цикл, вычитываем через receiveDatagram() всё, что накопилось.

Обработка: Из QNetworkDatagram берем данные (для текста) и адрес отправителя (для логов "Принято от...").